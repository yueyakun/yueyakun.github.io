<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>深入理解 Java 8 的 Lambda 表达式 | kun&#39;s blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/image/favicon.ico">
    <meta name="description" content="亚坤的博客">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/assets/css/0.styles.17b2530e.css" as="style"><link rel="preload" href="/assets/js/app.d40f22c0.js" as="script"><link rel="preload" href="/assets/js/3.e193f708.js" as="script"><link rel="preload" href="/assets/js/1.b7bb3f41.js" as="script"><link rel="preload" href="/assets/js/22.f9e79480.js" as="script"><link rel="prefetch" href="/assets/js/10.ad33044f.js"><link rel="prefetch" href="/assets/js/11.65f3a866.js"><link rel="prefetch" href="/assets/js/12.315ff73f.js"><link rel="prefetch" href="/assets/js/13.c8b5747d.js"><link rel="prefetch" href="/assets/js/14.f1fc7df5.js"><link rel="prefetch" href="/assets/js/15.e043e610.js"><link rel="prefetch" href="/assets/js/16.fe9f49ef.js"><link rel="prefetch" href="/assets/js/17.dbcde168.js"><link rel="prefetch" href="/assets/js/18.62b4bf43.js"><link rel="prefetch" href="/assets/js/19.fcd8e795.js"><link rel="prefetch" href="/assets/js/20.f49035e1.js"><link rel="prefetch" href="/assets/js/21.2fb34fad.js"><link rel="prefetch" href="/assets/js/23.b17c5e0a.js"><link rel="prefetch" href="/assets/js/24.d8db11d8.js"><link rel="prefetch" href="/assets/js/25.d3173bc3.js"><link rel="prefetch" href="/assets/js/26.07b3173a.js"><link rel="prefetch" href="/assets/js/27.b5732973.js"><link rel="prefetch" href="/assets/js/28.c8890416.js"><link rel="prefetch" href="/assets/js/29.aad4d05c.js"><link rel="prefetch" href="/assets/js/30.eee34f9a.js"><link rel="prefetch" href="/assets/js/31.b8e867f9.js"><link rel="prefetch" href="/assets/js/32.073bf00f.js"><link rel="prefetch" href="/assets/js/33.a12e09b1.js"><link rel="prefetch" href="/assets/js/34.6f79add3.js"><link rel="prefetch" href="/assets/js/35.4da4005e.js"><link rel="prefetch" href="/assets/js/36.1e96af73.js"><link rel="prefetch" href="/assets/js/37.1fcb1f4b.js"><link rel="prefetch" href="/assets/js/4.761a18ea.js"><link rel="prefetch" href="/assets/js/5.9df47b66.js"><link rel="prefetch" href="/assets/js/6.e9bf8e92.js"><link rel="prefetch" href="/assets/js/7.bf5e8554.js"><link rel="prefetch" href="/assets/js/8.27fd9b59.js"><link rel="prefetch" href="/assets/js/9.32bdd988.js">
    <link rel="stylesheet" href="/assets/css/0.styles.17b2530e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-dad8a512><div data-v-dad8a512><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-dad8a512 data-v-dad8a512><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-dad8a512 data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>kun's blog</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>kun</span>
            
          <span data-v-64685f0e>2017 - </span>
          2020
        </a></span></div></div> <div class="hide" data-v-dad8a512><header class="navbar" data-v-dad8a512><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/image/logo.gif" alt="kun's blog" class="logo"> <span class="site-name">kun's blog</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Spring/" class="nav-link"><i class="iconfont undefined"></i>
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java/" class="nav-link"><i class="iconfont undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/categories/DevOps/" class="nav-link"><i class="iconfont undefined"></i>
  DevOps
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java 并发/" class="nav-link"><i class="iconfont undefined"></i>
  Java 并发
</a></li><li class="dropdown-item"><!----> <a href="/categories/Blog/" class="nav-link"><i class="iconfont undefined"></i>
  Blog
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  tag
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-dad8a512></div> <aside class="sidebar" data-v-dad8a512><div class="personal-info-wrapper" data-v-b5d2cda6 data-v-dad8a512><img src="/image/avatar.jpg" alt="author-avatar" class="personal-img" data-v-b5d2cda6> <h3 class="name" data-v-b5d2cda6>
    kun
  </h3> <div class="num" data-v-b5d2cda6><div data-v-b5d2cda6><h3 data-v-b5d2cda6>19</h3> <h6 data-v-b5d2cda6>Article</h6></div> <div data-v-b5d2cda6><h3 data-v-b5d2cda6>17</h3> <h6 data-v-b5d2cda6>Tag</h6></div></div> <hr data-v-b5d2cda6></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Spring/" class="nav-link"><i class="iconfont undefined"></i>
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java/" class="nav-link"><i class="iconfont undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/categories/DevOps/" class="nav-link"><i class="iconfont undefined"></i>
  DevOps
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java 并发/" class="nav-link"><i class="iconfont undefined"></i>
  Java 并发
</a></li><li class="dropdown-item"><!----> <a href="/categories/Blog/" class="nav-link"><i class="iconfont undefined"></i>
  Blog
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  tag
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>深入理解 Java 8 的 Lambda 表达式</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>kun</span>
            
          <span data-v-64685f0e>2017 - </span>
          2020
        </a></span></div></div> <div data-v-dad8a512><main class="page"><div class="page-title" style="display:none;"><h1>深入理解 Java 8 的 Lambda 表达式</h1> <hr> <div data-v-aa64b9d0><i class="iconfont reco-account" data-v-aa64b9d0><span data-v-aa64b9d0>kun</span></i> <i class="iconfont reco-date" data-v-aa64b9d0><span data-v-aa64b9d0>2020-08-11 20:30:00</span></i> <!----> <i class="iconfont reco-tag tags" data-v-aa64b9d0><span class="tag-item" data-v-aa64b9d0>lambda</span><span class="tag-item" data-v-aa64b9d0>Java 8</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><h2 id="lambda-是什么"><a href="#lambda-是什么" class="header-anchor">#</a> Lambda 是什么</h2> <p>Lambda 表达式是 Java 8 新加入的语法特性。它的加入，弥补了 Java 不支持函数式编程的短板。合理的在项目中使用 Lambda 表达式，能使代码更加简洁。</p> <p>在学习 Lambda 之前需要先弄清楚什么是函数式编程和 Java 8 的函数式接口。</p> <h3 id="函数式编程（functional-programing）"><a href="#函数式编程（functional-programing）" class="header-anchor">#</a> 函数式编程（Functional Programing）</h3> <p>函数式编程和面向对象编程一样是一种编程思想。它允许向一个方法传入一个函数，也允许一个方法的返回结果是一个函数。如果说
面向对象编程更多的是对数据进行抽象， 那么函数式编程就是对行为（过程）进行抽象。</p> <h3 id="java-8-的函数式接口"><a href="#java-8-的函数式接口" class="header-anchor">#</a> Java 8 的函数式接口</h3> <p>函数式接口是在 Java 8 中为了支持函数式编程而推出的一个 Java 的语言特性。我们知道Java 是完全面向对象编程的语言，所有的方法都必须封装在一个类中，通过类或者对象才能调用方法。为了支持日渐流行的函数式编程，就推出了函数式接口这么个概念，算是以一种取巧的方式实现了函数式编程。</p> <p>Java的函数式接口的定义是：只有一个虚拟方法接口。但是函数式接口可以有一个或者多个 default 方法或者 static 方法。</p> <h3 id="jdk-自带的函数式接口"><a href="#jdk-自带的函数式接口" class="header-anchor">#</a> JDK 自带的函数式接口</h3> <p>我们可以自己定义函数式接口，但一般没这个必要，因为在 java.util.function 包中，JDK 已经为我们提供了几十种常用的函数式接口，下面列举一下常见的。</p> <ul><li>四个最基本的函数式接口</li></ul> <div class="language-Java extra-class"><pre class="language-java"><code><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">&gt;</span></span>：<span class="token class-name">R</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token class-name">T</span> t<span class="token punctuation">)</span>  输入类型<span class="token class-name">T</span>返回类型<span class="token class-name">R</span>。
<span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span>：<span class="token keyword">void</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token class-name">T</span> t<span class="token punctuation">)</span>  输入类型<span class="token class-name">T</span>，“消费”掉，无返回。
<span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span>：<span class="token keyword">boolean</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">T</span> t<span class="token punctuation">)</span>  输入类型<span class="token class-name">T</span>，并进行条件“判断”，返回<span class="token boolean">true</span><span class="token operator">|</span><span class="token boolean">false</span>。
<span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span>：<span class="token class-name">T</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  无输入，“生产”一个<span class="token class-name">T</span>类型的返回值。
</code></pre></div><ul><li>基本类型的函数式接口</li></ul> <p>上面这四个都使用了泛型，但是 Java 的基本类型是不支持泛型的，所以 JDK 还提供了一下基本类型的函数式接口</p> <div class="language-Java extra-class"><pre class="language-java"><code><span class="token comment">// double类型的</span>
<span class="token class-name">DoubleFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">R</span><span class="token punctuation">&gt;</span></span>：<span class="token class-name">R</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">double</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">DoubleConsumer</span>：<span class="token keyword">void</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token keyword">double</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">DoublePredicate</span>：<span class="token keyword">boolean</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">double</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">DoubleSupplier</span>：<span class="token keyword">double</span> <span class="token function">getAsDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// int类型的</span>
<span class="token class-name">IntFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">R</span><span class="token punctuation">&gt;</span></span>：<span class="token class-name">R</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">IntConsumer</span>：<span class="token keyword">void</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">IntPredicate</span>：<span class="token keyword">boolean</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">IntSupplier</span>：<span class="token keyword">int</span> <span class="token function">getAsInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 其他不再列举...</span>
</code></pre></div><ul><li>@FunctionalInterface 注解</li></ul> <p>@FunctionalInterface 注解是判断一个接口是不是函数式接口的充分不必要条件。</p> <p>只有函数式接口上才可以增加这个注解，不满足函数式接口条件的接口上加了这个注解或报错。是不是函数式接口的唯一判断条件是：是否只含有一个 abstract 方法，只要满足这个条件，不加 @FunctionalInterface 注解，也是函数式接口。</p> <h2 id="lambda-怎么用"><a href="#lambda-怎么用" class="header-anchor">#</a> Lambda 怎么用</h2> <h3 id="语法"><a href="#语法" class="header-anchor">#</a> 语法</h3> <p>Lambda 表达式有三部分组成：参数列表，箭头，以及一个表达式或语句块。这三部分实质上是一个函数式接口的实现。举个例子</p> <div class="language-Java extra-class"><pre class="language-java"><code><span class="token comment">// 匿名内部类写法</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Thread run()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Lambda表达式写法</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Thread run()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="类型推断"><a href="#类型推断" class="header-anchor">#</a> 类型推断</h3> <p>Lambda 可以这样简写的依据是编译器提供的类型推断功能。也就是说，虽然表达式没有指明自己实现了哪个接口，但是编译器能够根据表达式前后的代码，自己推断出 Lambda 要实现的接口。</p> <p>比如你可以用一个 λ 表达式为一个函数接口赋值：</p> <div class="language-Java extra-class"><pre class="language-java"><code>  <span class="token class-name">Runnable</span> r1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello Lambda!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>然后再赋值给一个Object：</p> <div class="language-Java extra-class"><pre class="language-java"><code>  <span class="token class-name">Object</span> obj <span class="token operator">=</span> r1<span class="token punctuation">;</span>
</code></pre></div><p>但却不能这样干：</p> <div class="language-Java extra-class"><pre class="language-java"><code>  <span class="token class-name">Object</span> obj <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello Lambda!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// ERROR! Object is not a functional interface!</span>
</code></pre></div><p>必须显式的转型成一个函数接口才可以：</p> <div class="language-Java extra-class"><pre class="language-java"><code>  <span class="token class-name">Object</span> o <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Runnable</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// correct</span>
</code></pre></div><p>一个 λ 表达式只有在转型成一个函数接口后才能被当做Object使用。所以下面这句也不能编译：</p> <div class="language-Java extra-class"><pre class="language-java"><code><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//错误! 目标类型不明</span>
</code></pre></div><p>必须先转型:</p> <div class="language-Java extra-class"><pre class="language-java"><code>  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token class-name">Runnable</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 正确</span>
</code></pre></div><h2 id="与匿名内部类的比较"><a href="#与匿名内部类的比较" class="header-anchor">#</a> 与匿名内部类的比较</h2> <ol><li><p>Lambda 表达式所代表的接口必须是一个函数接口，匿名内部类没有要求。</p></li> <li><p>编译器层面的实现原理不同
匿名内部类虽然不需要制定类名，但是编译器会自动创建该类并命名，比如下面这段使用匿名内部类的代码：</p></li></ol> <div class="language-Java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestLambda</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Runnable</span> anonymous <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;anonymous&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        
        anonymous<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们用 javac 命令编译后采用匿名内部类的实现会产生两个 class 文件，其中 TestLambda$1.class 就是编译器自己创建的匿名内部类的实现。</p> <p><img src="/posts/2020-08-11-java8-lambda/01.png" alt=""></p> <p>我们再用 javap -c -p TestLambda.class 命令反编译 TestLambda.class 文件，可以看到编译器确实自动增加了创建 TestLambda$1.class 类的命令</p> <p><img src="/posts/2020-08-11-java8-lambda/02.png" alt=""></p> <p>我们再采用 Lambda 表达式的方式来实现这段逻辑。</p> <div class="language-Java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestLambda</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Runnable</span> lambda <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;lambda&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lambda<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用 javac 命令编译后只有一个class文件产生</p> <p><img src="/posts/2020-08-11-java8-lambda/03.png" alt=""></p> <p>反编译后可以看到，编译器是自动在主类中生成了一个私有的静态方法，并通过 invokedynamic 指令来调用该方法来实现 Lambda 表达式的语义的。</p> <p><img src="/posts/2020-08-11-java8-lambda/04.png" alt=""></p> <ol start="3"><li>在 Lambda 表达式中 this 指向的是主类，而在匿名内部类中 this 指向的是匿名内部类自己，运行下面的例子可以证明</li></ol> <div class="language-Java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestLambda</span> <span class="token punctuation">{</span>
    <span class="token class-name">Runnable</span> r1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Runnable</span> r2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">TestLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>r1<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">TestLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>r2<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>运行结果为：</p> <blockquote><p>com.test.lambda.TestLambda@7699a589<br>
com.test.lambda.TestLambda$1@58372a00</p></blockquote> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>Lambda 表达式是 Java 8 新加入的语法特性，他的实现离不开函数式接口和编译器的支持。合理的使用它能使我们的代码简洁优雅。</p></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-40a3448a><li class="level-2" data-v-40a3448a><a href="/2020/2020-08-11-java8-lambda.html#lambda-是什么" class="sidebar-link" data-v-40a3448a>Lambda 是什么</a></li><li class="level-3" data-v-40a3448a><a href="/2020/2020-08-11-java8-lambda.html#函数式编程（functional-programing）" class="sidebar-link" data-v-40a3448a>函数式编程（Functional Programing）</a></li><li class="level-3" data-v-40a3448a><a href="/2020/2020-08-11-java8-lambda.html#java-8-的函数式接口" class="sidebar-link" data-v-40a3448a>Java 8 的函数式接口</a></li><li class="level-3" data-v-40a3448a><a href="/2020/2020-08-11-java8-lambda.html#jdk-自带的函数式接口" class="sidebar-link" data-v-40a3448a>JDK 自带的函数式接口</a></li><li class="level-2" data-v-40a3448a><a href="/2020/2020-08-11-java8-lambda.html#lambda-怎么用" class="sidebar-link" data-v-40a3448a>Lambda 怎么用</a></li><li class="level-3" data-v-40a3448a><a href="/2020/2020-08-11-java8-lambda.html#语法" class="sidebar-link" data-v-40a3448a>语法</a></li><li class="level-3" data-v-40a3448a><a href="/2020/2020-08-11-java8-lambda.html#类型推断" class="sidebar-link" data-v-40a3448a>类型推断</a></li><li class="level-2" data-v-40a3448a><a href="/2020/2020-08-11-java8-lambda.html#与匿名内部类的比较" class="sidebar-link" data-v-40a3448a>与匿名内部类的比较</a></li><li class="level-2" data-v-40a3448a><a href="/2020/2020-08-11-java8-lambda.html#总结" class="sidebar-link" data-v-40a3448a>总结</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div></div></div>
    <script src="/assets/js/app.d40f22c0.js" defer></script><script src="/assets/js/3.e193f708.js" defer></script><script src="/assets/js/1.b7bb3f41.js" defer></script><script src="/assets/js/22.f9e79480.js" defer></script>
  </body>
</html>
