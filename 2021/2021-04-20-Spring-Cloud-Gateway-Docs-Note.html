<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Spring Cloud Gateway 文档笔记 | kun&#39;s blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/image/favicon.ico">
    <meta name="description" content="聚沙成塔">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/assets/css/0.styles.17b2530e.css" as="style"><link rel="preload" href="/assets/js/app.fa674bd4.js" as="script"><link rel="preload" href="/assets/js/3.dae3c35c.js" as="script"><link rel="preload" href="/assets/js/1.b7bb3f41.js" as="script"><link rel="preload" href="/assets/js/45.a4655f26.js" as="script"><link rel="prefetch" href="/assets/js/10.4974cfe9.js"><link rel="prefetch" href="/assets/js/11.36e61f26.js"><link rel="prefetch" href="/assets/js/12.6ef5e369.js"><link rel="prefetch" href="/assets/js/13.65fb95b4.js"><link rel="prefetch" href="/assets/js/14.a59e7f25.js"><link rel="prefetch" href="/assets/js/15.66592cd2.js"><link rel="prefetch" href="/assets/js/16.50cc604c.js"><link rel="prefetch" href="/assets/js/17.2e41d2b1.js"><link rel="prefetch" href="/assets/js/18.62b4bf43.js"><link rel="prefetch" href="/assets/js/19.fbc4448a.js"><link rel="prefetch" href="/assets/js/20.9c1c2acf.js"><link rel="prefetch" href="/assets/js/21.3002e3db.js"><link rel="prefetch" href="/assets/js/22.d450b5a8.js"><link rel="prefetch" href="/assets/js/23.d13ca51d.js"><link rel="prefetch" href="/assets/js/24.6aae31e2.js"><link rel="prefetch" href="/assets/js/25.5ab79530.js"><link rel="prefetch" href="/assets/js/26.20784826.js"><link rel="prefetch" href="/assets/js/27.ba9c5e73.js"><link rel="prefetch" href="/assets/js/28.9dd8feef.js"><link rel="prefetch" href="/assets/js/29.276a5ff6.js"><link rel="prefetch" href="/assets/js/30.fad5a33f.js"><link rel="prefetch" href="/assets/js/31.a33fa42c.js"><link rel="prefetch" href="/assets/js/32.7b470c46.js"><link rel="prefetch" href="/assets/js/33.f7ba9f15.js"><link rel="prefetch" href="/assets/js/34.d453df8d.js"><link rel="prefetch" href="/assets/js/35.c4751c65.js"><link rel="prefetch" href="/assets/js/36.ba665325.js"><link rel="prefetch" href="/assets/js/37.349426e4.js"><link rel="prefetch" href="/assets/js/38.ec6b721e.js"><link rel="prefetch" href="/assets/js/39.8649f9de.js"><link rel="prefetch" href="/assets/js/4.b765c097.js"><link rel="prefetch" href="/assets/js/40.031be7a1.js"><link rel="prefetch" href="/assets/js/41.b2262675.js"><link rel="prefetch" href="/assets/js/42.77d81e65.js"><link rel="prefetch" href="/assets/js/43.14786f91.js"><link rel="prefetch" href="/assets/js/44.1547d5cd.js"><link rel="prefetch" href="/assets/js/46.1f6171fd.js"><link rel="prefetch" href="/assets/js/47.28f13b46.js"><link rel="prefetch" href="/assets/js/48.f6640b75.js"><link rel="prefetch" href="/assets/js/49.9c095072.js"><link rel="prefetch" href="/assets/js/5.9df47b66.js"><link rel="prefetch" href="/assets/js/50.ced15a6b.js"><link rel="prefetch" href="/assets/js/51.5b65c326.js"><link rel="prefetch" href="/assets/js/52.a8ae33f9.js"><link rel="prefetch" href="/assets/js/53.2fc0b04f.js"><link rel="prefetch" href="/assets/js/54.a9031e2e.js"><link rel="prefetch" href="/assets/js/6.a88d9340.js"><link rel="prefetch" href="/assets/js/7.bf5e8554.js"><link rel="prefetch" href="/assets/js/8.01673e7d.js"><link rel="prefetch" href="/assets/js/9.32bdd988.js">
    <link rel="stylesheet" href="/assets/css/0.styles.17b2530e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-dad8a512><div data-v-dad8a512><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-dad8a512 data-v-dad8a512><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-dad8a512 data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>kun's blog</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>kun</span>
            
          <span data-v-64685f0e>2020 - </span>
          2021
        </a></span></div></div> <div class="hide" data-v-dad8a512><header class="navbar" data-v-dad8a512><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/image/logo.gif" alt="kun's blog" class="logo"> <span class="site-name">kun's blog</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Blog/" class="nav-link"><i class="iconfont undefined"></i>
  Blog
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java/" class="nav-link"><i class="iconfont undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/categories/Spring/" class="nav-link"><i class="iconfont undefined"></i>
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/DevOps/" class="nav-link"><i class="iconfont undefined"></i>
  DevOps
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java 并发/" class="nav-link"><i class="iconfont undefined"></i>
  Java 并发
</a></li><li class="dropdown-item"><!----> <a href="/categories/Cache/" class="nav-link"><i class="iconfont undefined"></i>
  Cache
</a></li><li class="dropdown-item"><!----> <a href="/categories/API加密/" class="nav-link"><i class="iconfont undefined"></i>
  API加密
</a></li><li class="dropdown-item"><!----> <a href="/categories/Spring Cloud/" class="nav-link"><i class="iconfont undefined"></i>
  Spring Cloud
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  tag
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="https://github.com/yueyakun" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-dad8a512></div> <aside class="sidebar" data-v-dad8a512><div class="personal-info-wrapper" data-v-b5d2cda6 data-v-dad8a512><img src="/image/avatar.jpg" alt="author-avatar" class="personal-img" data-v-b5d2cda6> <h3 class="name" data-v-b5d2cda6>
    kun
  </h3> <div class="num" data-v-b5d2cda6><div data-v-b5d2cda6><h3 data-v-b5d2cda6>36</h3> <h6 data-v-b5d2cda6>Article</h6></div> <div data-v-b5d2cda6><h3 data-v-b5d2cda6>28</h3> <h6 data-v-b5d2cda6>Tag</h6></div></div> <hr data-v-b5d2cda6></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Blog/" class="nav-link"><i class="iconfont undefined"></i>
  Blog
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java/" class="nav-link"><i class="iconfont undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/categories/Spring/" class="nav-link"><i class="iconfont undefined"></i>
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/DevOps/" class="nav-link"><i class="iconfont undefined"></i>
  DevOps
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java 并发/" class="nav-link"><i class="iconfont undefined"></i>
  Java 并发
</a></li><li class="dropdown-item"><!----> <a href="/categories/Cache/" class="nav-link"><i class="iconfont undefined"></i>
  Cache
</a></li><li class="dropdown-item"><!----> <a href="/categories/API加密/" class="nav-link"><i class="iconfont undefined"></i>
  API加密
</a></li><li class="dropdown-item"><!----> <a href="/categories/Spring Cloud/" class="nav-link"><i class="iconfont undefined"></i>
  Spring Cloud
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  tag
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="https://github.com/yueyakun" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>Spring Cloud Gateway 文档笔记</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>kun</span>
            
          <span data-v-64685f0e>2020 - </span>
          2021
        </a></span></div></div> <div data-v-dad8a512><main class="page"><div class="page-title" style="display:none;"><h1>Spring Cloud Gateway 文档笔记</h1> <hr> <div data-v-aa64b9d0><i class="iconfont reco-account" data-v-aa64b9d0><span data-v-aa64b9d0>kun</span></i> <i class="iconfont reco-date" data-v-aa64b9d0><span data-v-aa64b9d0>2021-04-20</span></i> <!----> <i class="iconfont reco-tag tags" data-v-aa64b9d0><span class="tag-item" data-v-aa64b9d0>Gateway</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><p><a href="https://docs.spring.io/spring-cloud-gateway/docs/3.0.2/reference/html" target="_blank" rel="noopener noreferrer">3.0.2英文文档地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h1 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h1> <p>Spring Cloud Gateway旨在提供一种简单而有效的方式来路由api，并为它们提供切入点，如：安全性、监控/度量和弹性。</p> <h1 id="_1-引入"><a href="#_1-引入" class="header-anchor">#</a> 1. 引入</h1> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-gateway<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h1 id="_2-术语"><a href="#_2-术语" class="header-anchor">#</a> 2. 术语</h1> <p>Route：构建网关的基础，包含一个id，一个uri，一组断言（predicates）和一组过滤器（Filter）。断言组合如果为true，则路由匹配。</p> <p>Predicate：实际上就是 Java 8 中 Predicate 接口的实例，输入类型为 ServerWebExchange。通过他可以匹配来自HTTP请求的任何内容，例如头或参数。</p> <p>Filter：Spring Cloud 中 GatewayFilter 接口的实例，由特定的工厂类创建。</p> <p><em>注：ServerWebExchange：Since 5.0，提供对HTTP请求和响应的访问。</em></p> <h1 id="_3-工作流程："><a href="#_3-工作流程：" class="header-anchor">#</a> 3. 工作流程：</h1> <p><img src="/posts/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note/01.png" alt=""></p> <p>客户端向Spring Cloud Gateway 发出请求。如果网关处理程序映射确定请求与路由匹配，则将请求发送到网关 Web 处理程序。此处理程序通过特定的过滤器链运行请求。过滤器被虚线分隔的原因是：过滤器可以在发送代理请求之前和之后运行“pre”过滤逻辑。然后发出代理请求。发出代理请求后，将运行“post”过滤逻辑。</p> <h1 id="_4-配置断言和过滤"><a href="#_4-配置断言和过滤" class="header-anchor">#</a> 4. 配置断言和过滤</h1> <h2 id="_4-1-快捷配置"><a href="#_4-1-快捷配置" class="header-anchor">#</a> 4.1. 快捷配置</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> after_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> Cookie=mycookie<span class="token punctuation">,</span>mycookievalue
</code></pre></div><h2 id="_4-2-完整配置"><a href="#_4-2-完整配置" class="header-anchor">#</a> 4.2. 完整配置</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> after_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Cookie
          <span class="token key atrule">args</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> mycookie
            <span class="token key atrule">regexp</span><span class="token punctuation">:</span> mycookievalue
</code></pre></div><h1 id="_5-路由断言"><a href="#_5-路由断言" class="header-anchor">#</a> 5. 路由断言</h1> <h2 id="_5-1-after断言"><a href="#_5-1-after断言" class="header-anchor">#</a> 5.1. After断言</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> after_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> After=2017<span class="token punctuation">-</span>01<span class="token punctuation">-</span>20T17<span class="token punctuation">:</span>42<span class="token punctuation">:</span>47.789<span class="token punctuation">-</span>07<span class="token punctuation">:</span>00<span class="token punctuation">[</span>America/Denver<span class="token punctuation">]</span>
</code></pre></div><h2 id="_5-2-before断言"><a href="#_5-2-before断言" class="header-anchor">#</a> 5.2. Before断言</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> before_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> Before=2017<span class="token punctuation">-</span>01<span class="token punctuation">-</span>20T17<span class="token punctuation">:</span>42<span class="token punctuation">:</span>47.789<span class="token punctuation">-</span>07<span class="token punctuation">:</span>00<span class="token punctuation">[</span>America/Denver<span class="token punctuation">]</span>
</code></pre></div><h2 id="_5-3-between断言"><a href="#_5-3-between断言" class="header-anchor">#</a> 5.3. Between断言</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> between_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> Between=2017<span class="token punctuation">-</span>01<span class="token punctuation">-</span>20T17<span class="token punctuation">:</span>42<span class="token punctuation">:</span>47.789<span class="token punctuation">-</span>07<span class="token punctuation">:</span>00<span class="token punctuation">[</span>America/Denver<span class="token punctuation">]</span><span class="token punctuation">,</span> 2017<span class="token punctuation">-</span>01<span class="token punctuation">-</span>21T17<span class="token punctuation">:</span>42<span class="token punctuation">:</span>47.789<span class="token punctuation">-</span>07<span class="token punctuation">:</span>00<span class="token punctuation">[</span>America/Denver<span class="token punctuation">]</span>
</code></pre></div><h2 id="_5-4-cookie断言"><a href="#_5-4-cookie断言" class="header-anchor">#</a> 5.4. Cookie断言</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> cookie_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> Cookie=chocolate<span class="token punctuation">,</span> ch.p
</code></pre></div><h2 id="_5-5-header断言"><a href="#_5-5-header断言" class="header-anchor">#</a> 5.5. Header断言</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> header_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> Header=X<span class="token punctuation">-</span>Request<span class="token punctuation">-</span>Id<span class="token punctuation">,</span> \d+
</code></pre></div><h2 id="_5-6-host断言"><a href="#_5-6-host断言" class="header-anchor">#</a> 5.6. Host断言</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> host_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> Host=<span class="token important">**.somehost.org</span><span class="token punctuation">,</span><span class="token important">**.anotherhost.org</span>
</code></pre></div><p>URI 模板参数也是支持的，比如：{sub}.myhost.org，可以匹配 Header 中 Host 是 www.somehost.org 和beta.somehost.org。这些模板参数会被存储起来，在后面的过滤器链中可以通过 ServerWebExchange.getAttributes() 方法取到，key值是 ServerWebExchangeUtils.URI_TEMPLATE_VARIABLES_ATTRIBUTE。</p> <h2 id="_5-7-method断言"><a href="#_5-7-method断言" class="header-anchor">#</a> 5.7. Method断言</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> method_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> Method=GET<span class="token punctuation">,</span>POST
</code></pre></div><h2 id="_5-8-path断言"><a href="#_5-8-path断言" class="header-anchor">#</a> 5.8. Path断言</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> path_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> Path=/red/<span class="token punctuation">{</span>segment<span class="token punctuation">}</span><span class="token punctuation">,</span>/blue/<span class="token punctuation">{</span>segment<span class="token punctuation">}</span>
</code></pre></div><p>如果 matchTrailingSlash 设置为 false 的话，则请求路径 /red/1/ 是不匹配上面的路由的。</p> <p>这些模板参数一样会会被存储起来，在后面的过滤器链中可以通过 ServerWebExchange.getAttributes() 方法取到，key 值是 ServerWebExchangeUtils.URI_TEMPLATE_VARIABLES_ATTRIBUTE。</p> <p>下面是一个例子：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> uriVariables <span class="token operator">=</span> <span class="token class-name">ServerWebExchangeUtils</span><span class="token punctuation">.</span><span class="token function">getPathPredicateVariables</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> segment <span class="token operator">=</span> uriVariables<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;segment&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_5-9-path断言"><a href="#_5-9-path断言" class="header-anchor">#</a> 5.9. Path断言</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> query_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> Query=red<span class="token punctuation">,</span> gree.
</code></pre></div><p>gree. 是一个 regexp ，green、greet 都是匹配这个表达式的。</p> <h2 id="_5-10-remoteaddr断言"><a href="#_5-10-remoteaddr断言" class="header-anchor">#</a> 5.10. RemoteAddr断言</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> remoteaddr_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> RemoteAddr=192.168.1.1/24
</code></pre></div><h2 id="_5-10-修改-remoteaddr-的解析方式"><a href="#_5-10-修改-remoteaddr-的解析方式" class="header-anchor">#</a> 5.10. 修改 RemoteAddr 的解析方式</h2> <p>如果 Spring Cloud Gateway 在一个代理服务的后面，那么拿到的 RemoteAddr 可能不是真实的。可以通过自定义一个 RemoteAddressResolver 来解析出真实的 RemoteAddr 。Spring Cloud Gateway 附带了一个非默认的远程地址解析器 -- XForwardedRemoteAddressResolve，它基于 X-Forwarded-For 请求头来解析出真实的远程地址</p> <p>使用方式：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">RemoteAddressResolver</span> resolver <span class="token operator">=</span> <span class="token class-name">XForwardedRemoteAddressResolver</span>
    <span class="token punctuation">.</span><span class="token function">maxTrustedIndex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">&quot;direct-route&quot;</span><span class="token punctuation">,</span>
    r <span class="token operator">-&gt;</span> r<span class="token punctuation">.</span><span class="token function">remoteAddr</span><span class="token punctuation">(</span><span class="token string">&quot;10.1.1.1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;10.10.1.1/24&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">&quot;https://downstream1&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">&quot;proxied-route&quot;</span><span class="token punctuation">,</span>
    r <span class="token operator">-&gt;</span> r<span class="token punctuation">.</span><span class="token function">remoteAddr</span><span class="token punctuation">(</span>resolver<span class="token punctuation">,</span> <span class="token string">&quot;10.10.1.1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;10.10.1.1/24&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">&quot;https://downstream2&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="_5-11-weight断言"><a href="#_5-11-weight断言" class="header-anchor">#</a> 5.11. Weight断言</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> weight_high
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//weighthigh.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> Weight=group1<span class="token punctuation">,</span> <span class="token number">8</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> weight_low
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//weightlow.org
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> Weight=group1<span class="token punctuation">,</span> <span class="token number">2</span>
</code></pre></div><p>Weight断言需要提供两个参数，group 和 weight。</p> <h1 id="_6-gatewayfilter"><a href="#_6-gatewayfilter" class="header-anchor">#</a> 6. GatewayFilter</h1> <h2 id="_6-1-addrequestheader-过滤器"><a href="#_6-1-addrequestheader-过滤器" class="header-anchor">#</a> 6.1. AddRequestHeader 过滤器</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> add_request_header_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">filters</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> AddRequestHeader=X<span class="token punctuation">-</span>Request<span class="token punctuation">-</span>red<span class="token punctuation">,</span> blue
</code></pre></div><h1 id="_7-globalfilter"><a href="#_7-globalfilter" class="header-anchor">#</a> 7. GlobalFilter</h1> <h1 id="_8-httpheadersfilters"><a href="#_8-httpheadersfilters" class="header-anchor">#</a> 8. HttpHeadersFilters</h1> <h1 id="_9-tls-and-ssl"><a href="#_9-tls-and-ssl" class="header-anchor">#</a> 9. TLS and SSL</h1> <h1 id="_10-configuration"><a href="#_10-configuration" class="header-anchor">#</a> 10. Configuration</h1> <p>Spring Cloud Gateway 的配置是由一组 RouteDefinitionLocator 实例驱动的。默认情况下，PropertiesRouteDefinitionLocator 通过使用 Spring Boot 的 @ConfigurationProperties 机制来加载属性。</p> <p>下面的两种配置方式是等价的：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> setstatus_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">filters</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> SetStatus
          <span class="token key atrule">args</span><span class="token punctuation">:</span>
            <span class="token key atrule">status</span><span class="token punctuation">:</span> <span class="token number">401</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> setstatusshortcut_route
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">filters</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> SetStatus=401
</code></pre></div><h1 id="_11-配置路由元数据"><a href="#_11-配置路由元数据" class="header-anchor">#</a> 11. 配置路由元数据</h1> <p>可以使用元数据为每个路由配置额外的参数：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> route_with_metadata
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
        <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
          <span class="token key atrule">optionName</span><span class="token punctuation">:</span> <span class="token string">&quot;OptionValue&quot;</span>
          <span class="token key atrule">compositeObject</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;value&quot;</span>
          <span class="token key atrule">iAmNumber</span><span class="token punctuation">:</span> <span class="token number">1</span>
</code></pre></div><p>可以从一个exchange中获取元数据</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Route</span> route <span class="token operator">=</span> exchange<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span>GATEWAY_ROUTE_ATTR<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// get all metadata properties</span>
route<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// get a single metadata property</span>
route<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span>someKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="_12-http-超时配置"><a href="#_12-http-超时配置" class="header-anchor">#</a> 12. Http 超时配置</h1> <h2 id="_12-3-流式-java-api"><a href="#_12-3-流式-java-api" class="header-anchor">#</a> 12.3. 流式 Java API</h2> <p>RouteLocatorBuilder 提供了一套流式的 API，用法如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// static imports from GatewayFilters and RoutePredicates</span>
<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">RouteLocator</span> <span class="token function">customRouteLocator</span><span class="token punctuation">(</span><span class="token class-name">RouteLocatorBuilder</span> builder<span class="token punctuation">,</span> <span class="token class-name">ThrottleGatewayFilterFactory</span> throttle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span>r <span class="token operator">-&gt;</span> r<span class="token punctuation">.</span><span class="token function">host</span><span class="token punctuation">(</span><span class="token string">&quot;**.abc.org&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">&quot;/image/png&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">filters</span><span class="token punctuation">(</span>f <span class="token operator">-&gt;</span>
                        f<span class="token punctuation">.</span><span class="token function">addResponseHeader</span><span class="token punctuation">(</span><span class="token string">&quot;X-TestHeader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;foobar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">&quot;http://httpbin.org:80&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span>r <span class="token operator">-&gt;</span> r<span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">&quot;/image/webp&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">filters</span><span class="token punctuation">(</span>f <span class="token operator">-&gt;</span>
                        f<span class="token punctuation">.</span><span class="token function">addResponseHeader</span><span class="token punctuation">(</span><span class="token string">&quot;X-AnotherHeader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;baz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">&quot;http://httpbin.org:80&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">metadata</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span>r <span class="token operator">-&gt;</span> r<span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">host</span><span class="token punctuation">(</span><span class="token string">&quot;**.throttle.org&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">&quot;/get&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">filters</span><span class="token punctuation">(</span>f <span class="token operator">-&gt;</span> f<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>throttle<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>
                        <span class="token number">1</span><span class="token punctuation">,</span>
                        <span class="token number">10</span><span class="token punctuation">,</span>
                        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">&quot;http://httpbin.org:80&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">metadata</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>不仅可以用 and() 连接，还可以用 or()，negate()。</p> <h2 id="_12-4-服务发现路由配置"><a href="#_12-4-服务发现路由配置" class="header-anchor">#</a> 12.4. 服务发现路由配置</h2> <p>开启方式：</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">spring.cloud.gateway.discovery.locator.enabled</span><span class="token punctuation">=</span><span class="token attr-value">true</span>
</code></pre></div><h3 id="_12-4-1-配置路由，指向注册中心中的其他服务"><a href="#_12-4-1-配置路由，指向注册中心中的其他服务" class="header-anchor">#</a> 12.4.1. 配置路由，指向注册中心中的其他服务</h3> <p>默认情况下，网关为使用DiscoveryClient创建的路由定义一个单独的断言和过滤器。默认的断言是一个 Path 断言，模式是：/serviceId/**，serviceId 就是注册中心中的服务 id。</p> <p>默认的 filter 是一个 rewrite path filter，表达式是：/serviceId/?(?<remaining>.*)，重写成：/${remaining}。从而在请求发送到下游之前从路径中剥离服务ID。</remaining></p> <p>如果想自定义，可以通过以下参数配置生效：</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token comment">#spring.cloud.gateway.discovery.locator.predicates[x]</span>
<span class="token comment">#spring.cloud.gateway.discovery.locator.filters[y]</span>
<span class="token attr-name">spring.cloud.gateway.discovery.locator.predicates[0].name</span><span class="token punctuation">:</span> <span class="token attr-value">Path</span>
<span class="token attr-name">spring.cloud.gateway.discovery.locator.predicates[0].args[pattern]</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;'/'+serviceId+'/**'&quot;</span>
<span class="token attr-name">spring.cloud.gateway.discovery.locator.predicates[1].name</span><span class="token punctuation">:</span> <span class="token attr-value">Host</span>
<span class="token attr-name">spring.cloud.gateway.discovery.locator.predicates[1].args[pattern]</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;'**.foo.com'&quot;</span>
<span class="token attr-name">spring.cloud.gateway.discovery.locator.filters[0].name</span><span class="token punctuation">:</span> <span class="token attr-value">CircuitBreaker</span>
<span class="token attr-name">spring.cloud.gateway.discovery.locator.filters[0].args[name]</span><span class="token punctuation">:</span> <span class="token attr-value">serviceId</span>
<span class="token attr-name">spring.cloud.gateway.discovery.locator.filters[1].name</span><span class="token punctuation">:</span> <span class="token attr-value">RewritePath</span>
<span class="token attr-name">spring.cloud.gateway.discovery.locator.filters[1].args[regexp]</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;'/' + serviceId + '/?(?&lt;remaining&gt;.*)'&quot;</span>
<span class="token attr-name">spring.cloud.gateway.discovery.locator.filters[1].args[replacement]</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;'/${remaining}'&quot;</span>
</code></pre></div><h1 id="_13-reactor-netty-access-logs"><a href="#_13-reactor-netty-access-logs" class="header-anchor">#</a> 13. Reactor Netty Access Logs</h1> <p>开启 Reactor Netty 日志的设置是：-Dreactor.netty.http.server.accessLogEnabled=true</p> <p>注意这是一个 JVM 配置。</p> <p>logback 示例配置：</p> <div class="language-xml extra-class"><pre class="language-xml"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>accessLog<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.FileAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">&gt;</span></span>access_log.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>async<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.classic.AsyncAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>accessLog<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>reactor.netty.http.server.AccessLog<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>INFO<span class="token punctuation">&quot;</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>async<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h1 id="_14-cors-configuration"><a href="#_14-cors-configuration" class="header-anchor">#</a> 14. CORS Configuration</h1> <p>可以通过配置 Gateway 控制 CORS 行为。下面是一个全局的 CORS 配置示例：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">globalcors</span><span class="token punctuation">:</span>
        <span class="token key atrule">cors-configurations</span><span class="token punctuation">:</span>
          '<span class="token punctuation">[</span>/<span class="token important">**</span><span class="token punctuation">]</span>'<span class="token punctuation">:</span>
            <span class="token key atrule">allowedOrigins</span><span class="token punctuation">:</span> <span class="token string">&quot;https://docs.spring.io&quot;</span>
            <span class="token key atrule">allowedMethods</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> GET
</code></pre></div><p>要为没有被网关路由断言处理的请求提供相同的 CORS 配置，请设置下面属性为 true。</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">spring.cloud.gateway.globalcors.add-to-simple-url-handler-mapping</span><span class="token punctuation">=</span><span class="token attr-value">true</span>
</code></pre></div><p>这个设置也可以用来支撑 CORS 预检查接口，（预检查接口的请求类型是 options）。</p> <h1 id="_15-actuator-api"><a href="#_15-actuator-api" class="header-anchor">#</a> 15. Actuator API</h1> <p>下面的配置可以开启 /gateway 端点，</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">management.endpoint.gateway.enabled</span><span class="token punctuation">=</span><span class="token attr-value">true # default value</span>
<span class="token attr-name">management.endpoints.web.exposure.include</span><span class="token punctuation">=</span><span class="token attr-value">gateway</span>
</code></pre></div><h2 id="_15-1-检索路由"><a href="#_15-1-检索路由" class="header-anchor">#</a> 15.1. 检索路由</h2> <p>/actuator/gateway/routes</p> <p>访问这个端点可以展示详细的 route 信息？</p> <p>不想暴露详细的 route 信息可以通过以下配置关闭：</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">spring.cloud.gateway.actuator.verbose.enabled</span><span class="token punctuation">=</span><span class="token attr-value">false</span>
</code></pre></div><h2 id="_15-2-检索过滤器"><a href="#_15-2-检索过滤器" class="header-anchor">#</a> 15.2. 检索过滤器</h2> <h3 id="_15-2-1-检索全局过滤器"><a href="#_15-2-1-检索全局过滤器" class="header-anchor">#</a> 15.2.1. 检索全局过滤器</h3> <p>/actuator/gateway/globalfilters</p> <h3 id="_15-2-2-检索路由过滤器"><a href="#_15-2-2-检索路由过滤器" class="header-anchor">#</a> 15.2.2. 检索路由过滤器</h3> <p>/actuator/gateway/routefilters</p> <h2 id="_15-3-刷新-route-缓存"><a href="#_15-3-刷新-route-缓存" class="header-anchor">#</a> 15.3. 刷新 Route 缓存</h2> <p>/actuator/gateway/refresh，POST</p> <h2 id="_15-4-检索路由配置"><a href="#_15-4-检索路由配置" class="header-anchor">#</a> 15.4. 检索路由配置</h2> <p>/actuator/gateway/routes</p> <h2 id="_15-5-检索单个路由配置"><a href="#_15-5-检索单个路由配置" class="header-anchor">#</a> 15.5. 检索单个路由配置</h2> <p>/actuator/gateway/routes/{id}</p> <h2 id="_15-6-创建或者删除单个路由配置"><a href="#_15-6-创建或者删除单个路由配置" class="header-anchor">#</a> 15.6. 创建或者删除单个路由配置</h2> <p>/gateway/routes/{id_route_to_create}，POST</p> <p>/gateway/routes/{id_route_to_create}，DELETE</p> <h2 id="_15-7-所有端点的列表"><a href="#_15-7-所有端点的列表" class="header-anchor">#</a> 15.7. 所有端点的列表</h2> <table><thead><tr><th style="text-align:left;">ID</th> <th style="text-align:left;">HTTP Method</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>globalfilters</code></td> <td style="text-align:left;">GET</td> <td style="text-align:left;">Displays the list of global filters applied to the routes.</td></tr> <tr><td style="text-align:left;"><code>routefilters</code></td> <td style="text-align:left;">GET</td> <td style="text-align:left;">Displays the list of <code>GatewayFilter</code> factories applied to a particular route.</td></tr> <tr><td style="text-align:left;"><code>refresh</code></td> <td style="text-align:left;">POST</td> <td style="text-align:left;">Clears the routes cache.</td></tr> <tr><td style="text-align:left;"><code>routes</code></td> <td style="text-align:left;">GET</td> <td style="text-align:left;">Displays the list of routes defined in the gateway.</td></tr> <tr><td style="text-align:left;"><code>routes/{id}</code></td> <td style="text-align:left;">GET</td> <td style="text-align:left;">Displays information about a particular route.</td></tr> <tr><td style="text-align:left;"><code>routes/{id}</code></td> <td style="text-align:left;">POST</td> <td style="text-align:left;">Adds a new route to the gateway.</td></tr> <tr><td style="text-align:left;"><code>routes/{id}</code></td> <td style="text-align:left;">DELETE</td> <td style="text-align:left;">Removes an existing route from the gateway.</td></tr></tbody></table> <h1 id="_16-故障排除"><a href="#_16-故障排除" class="header-anchor">#</a> 16. 故障排除</h1> <h1 id="_17-开发者指南"><a href="#_17-开发者指南" class="header-anchor">#</a> 17. 开发者指南</h1> <h2 id="_17-1-自定义断言"><a href="#_17-1-自定义断言" class="header-anchor">#</a> 17.1. 自定义断言</h2> <h2 id="_17-2-自定义-gatewayfilter"><a href="#_17-2-自定义-gatewayfilter" class="header-anchor">#</a> 17.2. 自定义 GatewayFilter</h2> <h2 id="_17-3-自定义-globalfilter"><a href="#_17-3-自定义-globalfilter" class="header-anchor">#</a> 17.3. 自定义 GlobalFilter</h2> <h1 id="_18-使用-spring-mvc-或者-webflux-创建一个简单的网关"><a href="#_18-使用-spring-mvc-或者-webflux-创建一个简单的网关" class="header-anchor">#</a> 18. 使用 Spring MVC 或者 Webflux 创建一个简单的网关</h1> <h1 id="_19-配置项"><a href="#_19-配置项" class="header-anchor">#</a> 19. 配置项</h1> <table><thead><tr><th style="text-align:left;">Name</th> <th style="text-align:left;">Default</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;">spring.cloud.gateway.default-filters</td> <td style="text-align:left;"></td> <td style="text-align:left;">List of filter definitions that are applied to every route.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.discovery.locator.enabled</td> <td style="text-align:left;"><code>false</code></td> <td style="text-align:left;">Flag that enables DiscoveryClient gateway integration.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.discovery.locator.filters</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.discovery.locator.include-expression</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">SpEL expression that will evaluate whether to include a service in gateway integration or not, defaults to: true.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.discovery.locator.lower-case-service-id</td> <td style="text-align:left;"><code>false</code></td> <td style="text-align:left;">Option to lower case serviceId in predicates and filters, defaults to false. Useful with eureka when it automatically uppercases serviceId. so MYSERIVCE, would match /myservice/**</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.discovery.locator.predicates</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.discovery.locator.route-id-prefix</td> <td style="text-align:left;"></td> <td style="text-align:left;">The prefix for the routeId, defaults to discoveryClient.getClass().getSimpleName() + &quot;_&quot;. Service Id will be appended to create the routeId.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.discovery.locator.url-expression</td> <td style="text-align:left;"><code>'lb://'+serviceId</code></td> <td style="text-align:left;">SpEL expression that create the uri for each route, defaults to: 'lb://'+serviceId.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables gateway functionality.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.fail-on-route-definition-error</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Option to fail on route definition errors, defaults to true. Otherwise, a warning is logged.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.add-request-header.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the add-request-header filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.add-request-parameter.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the add-request-parameter filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.add-response-header.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the add-response-header filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.circuit-breaker.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the circuit-breaker filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.dedupe-response-header.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the dedupe-response-header filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.fallback-headers.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the fallback-headers filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.hystrix.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the hystrix filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.map-request-header.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the map-request-header filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.modify-request-body.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the modify-request-body filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.modify-response-body.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the modify-response-body filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.prefix-path.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the prefix-path filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.preserve-host-header.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the preserve-host-header filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.redirect-to.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the redirect-to filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.remove-hop-by-hop.headers</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.remove-hop-by-hop.order</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.remove-request-header.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the remove-request-header filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.remove-request-parameter.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the remove-request-parameter filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.remove-response-header.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the remove-response-header filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.request-header-size.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the request-header-size filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.request-header-to-request-uri.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the request-header-to-request-uri filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.request-rate-limiter.deny-empty-key</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Switch to deny requests if the Key Resolver returns an empty key, defaults to true.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.request-rate-limiter.empty-key-status-code</td> <td style="text-align:left;"></td> <td style="text-align:left;">HttpStatus to return when denyEmptyKey is true, defaults to FORBIDDEN.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.request-rate-limiter.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the request-rate-limiter filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.request-size.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the request-size filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.retry.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the retry filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.rewrite-location-response-header.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the rewrite-location-response-header filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.rewrite-location.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the rewrite-location filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.rewrite-path.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the rewrite-path filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.rewrite-response-header.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the rewrite-response-header filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.save-session.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the save-session filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.secure-headers.content-security-policy</td> <td style="text-align:left;"><code>default-src 'self' https:; font-src 'self' https: data:; img-src 'self' https: data:; object-src 'none'; script-src https:; style-src 'self' https: 'unsafe-inline'</code></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.secure-headers.content-type-options</td> <td style="text-align:left;"><code>nosniff</code></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.secure-headers.disable</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.secure-headers.download-options</td> <td style="text-align:left;"><code>noopen</code></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.secure-headers.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the secure-headers filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.secure-headers.frame-options</td> <td style="text-align:left;"><code>DENY</code></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.secure-headers.permitted-cross-domain-policies</td> <td style="text-align:left;"><code>none</code></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.secure-headers.referrer-policy</td> <td style="text-align:left;"><code>no-referrer</code></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.secure-headers.strict-transport-security</td> <td style="text-align:left;"><code>max-age=631138519</code></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.secure-headers.xss-protection-header</td> <td style="text-align:left;"><code>1 ; mode=block</code></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.set-path.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the set-path filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.set-request-header.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the set-request-header filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.set-request-host-header.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the set-request-host-header filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.set-response-header.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the set-response-header filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.set-status.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the set-status filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.filter.strip-prefix.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the strip-prefix filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.forwarded.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the ForwardedHeadersFilter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.global-filter.adapt-cached-body.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the adapt-cached-body global filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.global-filter.forward-path.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the forward-path global filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.global-filter.forward-routing.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the forward-routing global filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.global-filter.load-balancer-client.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the load-balancer-client global filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.global-filter.netty-routing.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the netty-routing global filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.global-filter.netty-write-response.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the netty-write-response global filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.global-filter.reactive-load-balancer-client.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the reactive-load-balancer-client global filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.global-filter.remove-cached-body.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the remove-cached-body global filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.global-filter.route-to-request-url.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the route-to-request-url global filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.global-filter.websocket-routing.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the websocket-routing global filter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.globalcors.add-to-simple-url-handler-mapping</td> <td style="text-align:left;"><code>false</code></td> <td style="text-align:left;">If global CORS config should be added to the URL handler.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.globalcors.cors-configurations</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.compression</td> <td style="text-align:left;"><code>false</code></td> <td style="text-align:left;">Enables compression for Netty HttpClient.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.connect-timeout</td> <td style="text-align:left;"></td> <td style="text-align:left;">The connect timeout in millis, the default is 45s.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.max-header-size</td> <td style="text-align:left;"></td> <td style="text-align:left;">The max response header size.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.max-initial-line-length</td> <td style="text-align:left;"></td> <td style="text-align:left;">The max initial line length.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.pool.acquire-timeout</td> <td style="text-align:left;"></td> <td style="text-align:left;">Only for type FIXED, the maximum time in millis to wait for aquiring.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.pool.max-connections</td> <td style="text-align:left;"></td> <td style="text-align:left;">Only for type FIXED, the maximum number of connections before starting pending acquisition on existing ones.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.pool.max-idle-time</td> <td style="text-align:left;"></td> <td style="text-align:left;">Time in millis after which the channel will be closed. If NULL, there is no max idle time.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.pool.max-life-time</td> <td style="text-align:left;"></td> <td style="text-align:left;">Duration after which the channel will be closed. If NULL, there is no max life time.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.pool.name</td> <td style="text-align:left;"><code>proxy</code></td> <td style="text-align:left;">The channel pool map name, defaults to proxy.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.pool.type</td> <td style="text-align:left;"></td> <td style="text-align:left;">Type of pool for HttpClient to use, defaults to ELASTIC.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.proxy.host</td> <td style="text-align:left;"></td> <td style="text-align:left;">Hostname for proxy configuration of Netty HttpClient.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.proxy.non-proxy-hosts-pattern</td> <td style="text-align:left;"></td> <td style="text-align:left;">Regular expression (Java) for a configured list of hosts. that should be reached directly, bypassing the proxy</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.proxy.password</td> <td style="text-align:left;"></td> <td style="text-align:left;">Password for proxy configuration of Netty HttpClient.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.proxy.port</td> <td style="text-align:left;"></td> <td style="text-align:left;">Port for proxy configuration of Netty HttpClient.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.proxy.type</td> <td style="text-align:left;"></td> <td style="text-align:left;">proxyType for proxy configuration of Netty HttpClient.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.proxy.username</td> <td style="text-align:left;"></td> <td style="text-align:left;">Username for proxy configuration of Netty HttpClient.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.response-timeout</td> <td style="text-align:left;"></td> <td style="text-align:left;">The response timeout.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.ssl.close-notify-flush-timeout</td> <td style="text-align:left;"><code>3000ms</code></td> <td style="text-align:left;">SSL close_notify flush timeout. Default to 3000 ms.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.ssl.close-notify-read-timeout</td> <td style="text-align:left;"><code>0</code></td> <td style="text-align:left;">SSL close_notify read timeout. Default to 0 ms.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.ssl.default-configuration-type</td> <td style="text-align:left;"></td> <td style="text-align:left;">The default ssl configuration type. Defaults to TCP.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.ssl.handshake-timeout</td> <td style="text-align:left;"><code>10000ms</code></td> <td style="text-align:left;">SSL handshake timeout. Default to 10000 ms</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.ssl.key-password</td> <td style="text-align:left;"></td> <td style="text-align:left;">Key password, default is same as keyStorePassword.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.ssl.key-store</td> <td style="text-align:left;"></td> <td style="text-align:left;">Keystore path for Netty HttpClient.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.ssl.key-store-password</td> <td style="text-align:left;"></td> <td style="text-align:left;">Keystore password.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.ssl.key-store-provider</td> <td style="text-align:left;"></td> <td style="text-align:left;">Keystore provider for Netty HttpClient, optional field.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.ssl.key-store-type</td> <td style="text-align:left;"><code>JKS</code></td> <td style="text-align:left;">Keystore type for Netty HttpClient, default is JKS.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.ssl.trusted-x509-certificates</td> <td style="text-align:left;"></td> <td style="text-align:left;">Trusted certificates for verifying the remote endpoint’s certificate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.ssl.use-insecure-trust-manager</td> <td style="text-align:left;"><code>false</code></td> <td style="text-align:left;">Installs the netty InsecureTrustManagerFactory. This is insecure and not suitable for production.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.websocket.max-frame-payload-length</td> <td style="text-align:left;"></td> <td style="text-align:left;">Max frame payload length.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.websocket.proxy-ping</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Proxy ping frames to downstream services, defaults to true.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpclient.wiretap</td> <td style="text-align:left;"><code>false</code></td> <td style="text-align:left;">Enables wiretap debugging for Netty HttpClient.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.httpserver.wiretap</td> <td style="text-align:left;"><code>false</code></td> <td style="text-align:left;">Enables wiretap debugging for Netty HttpServer.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.loadbalancer.use404</td> <td style="text-align:left;"><code>false</code></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.metrics.enabled</td> <td style="text-align:left;"><code>false</code></td> <td style="text-align:left;">Enables the collection of metrics data.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.metrics.prefix</td> <td style="text-align:left;"><code>spring.cloud.gateway</code></td> <td style="text-align:left;">The prefix of all metrics emitted by gateway.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.metrics.tags</td> <td style="text-align:left;"></td> <td style="text-align:left;">Tags map that added to metrics.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.predicate.after.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the after predicate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.predicate.before.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the before predicate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.predicate.between.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the between predicate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.predicate.cloud-foundry-route-service.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the cloud-foundry-route-service predicate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.predicate.cookie.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the cookie predicate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.predicate.header.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the header predicate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.predicate.host.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the host predicate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.predicate.method.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the method predicate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.predicate.path.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the path predicate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.predicate.query.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the query predicate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.predicate.read-body.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the read-body predicate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.predicate.remote-addr.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the remote-addr predicate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.predicate.weight.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables the weight predicate.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.redis-rate-limiter.burst-capacity-header</td> <td style="text-align:left;"><code>X-RateLimit-Burst-Capacity</code></td> <td style="text-align:left;">The name of the header that returns the burst capacity configuration.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.redis-rate-limiter.config</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.redis-rate-limiter.include-headers</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Whether or not to include headers containing rate limiter information, defaults to true.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.redis-rate-limiter.remaining-header</td> <td style="text-align:left;"><code>X-RateLimit-Remaining</code></td> <td style="text-align:left;">The name of the header that returns number of remaining requests during the current second.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.redis-rate-limiter.replenish-rate-header</td> <td style="text-align:left;"><code>X-RateLimit-Replenish-Rate</code></td> <td style="text-align:left;">The name of the header that returns the replenish rate configuration.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.redis-rate-limiter.requested-tokens-header</td> <td style="text-align:left;"><code>X-RateLimit-Requested-Tokens</code></td> <td style="text-align:left;">The name of the header that returns the requested tokens configuration.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.routes</td> <td style="text-align:left;"></td> <td style="text-align:left;">List of Routes.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.set-status.original-status-header-name</td> <td style="text-align:left;"></td> <td style="text-align:left;">The name of the header which contains http code of the proxied request.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.streaming-media-types</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.x-forwarded.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">If the XForwardedHeadersFilter is enabled.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.x-forwarded.for-append</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">If appending X-Forwarded-For as a list is enabled.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.x-forwarded.for-enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">If X-Forwarded-For is enabled.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.x-forwarded.host-append</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">If appending X-Forwarded-Host as a list is enabled.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.x-forwarded.host-enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">If X-Forwarded-Host is enabled.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.x-forwarded.order</td> <td style="text-align:left;"><code>0</code></td> <td style="text-align:left;">The order of the XForwardedHeadersFilter.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.x-forwarded.port-append</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">If appending X-Forwarded-Port as a list is enabled.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.x-forwarded.port-enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">If X-Forwarded-Port is enabled.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.x-forwarded.prefix-append</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">If appending X-Forwarded-Prefix as a list is enabled.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.x-forwarded.prefix-enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">If X-Forwarded-Prefix is enabled.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.x-forwarded.proto-append</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">If appending X-Forwarded-Proto as a list is enabled.</td></tr> <tr><td style="text-align:left;">spring.cloud.gateway.x-forwarded.proto-enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">If X-Forwarded-Proto is enabled.</td></tr></tbody></table></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-40a3448a><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_4-1-快捷配置" class="sidebar-link" data-v-40a3448a>4.1. 快捷配置</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_4-2-完整配置" class="sidebar-link" data-v-40a3448a>4.2. 完整配置</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_5-1-after断言" class="sidebar-link" data-v-40a3448a>5.1. After断言</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_5-2-before断言" class="sidebar-link" data-v-40a3448a>5.2. Before断言</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_5-3-between断言" class="sidebar-link" data-v-40a3448a>5.3. Between断言</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_5-4-cookie断言" class="sidebar-link" data-v-40a3448a>5.4. Cookie断言</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_5-5-header断言" class="sidebar-link" data-v-40a3448a>5.5. Header断言</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_5-6-host断言" class="sidebar-link" data-v-40a3448a>5.6. Host断言</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_5-7-method断言" class="sidebar-link" data-v-40a3448a>5.7. Method断言</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_5-8-path断言" class="sidebar-link" data-v-40a3448a>5.8. Path断言</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_5-9-path断言" class="sidebar-link" data-v-40a3448a>5.9. Path断言</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_5-10-remoteaddr断言" class="sidebar-link" data-v-40a3448a>5.10. RemoteAddr断言</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_5-10-修改-remoteaddr-的解析方式" class="sidebar-link" data-v-40a3448a>5.10. 修改 RemoteAddr 的解析方式</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_5-11-weight断言" class="sidebar-link" data-v-40a3448a>5.11. Weight断言</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_6-1-addrequestheader-过滤器" class="sidebar-link" data-v-40a3448a>6.1. AddRequestHeader 过滤器</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_12-3-流式-java-api" class="sidebar-link" data-v-40a3448a>12.3. 流式 Java API</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_12-4-服务发现路由配置" class="sidebar-link" data-v-40a3448a>12.4. 服务发现路由配置</a></li><li class="level-3" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_12-4-1-配置路由，指向注册中心中的其他服务" class="sidebar-link" data-v-40a3448a>12.4.1. 配置路由，指向注册中心中的其他服务</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_15-1-检索路由" class="sidebar-link" data-v-40a3448a>15.1. 检索路由</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_15-2-检索过滤器" class="sidebar-link" data-v-40a3448a>15.2. 检索过滤器</a></li><li class="level-3" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_15-2-1-检索全局过滤器" class="sidebar-link" data-v-40a3448a>15.2.1. 检索全局过滤器</a></li><li class="level-3" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_15-2-2-检索路由过滤器" class="sidebar-link" data-v-40a3448a>15.2.2. 检索路由过滤器</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_15-3-刷新-route-缓存" class="sidebar-link" data-v-40a3448a>15.3. 刷新 Route 缓存</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_15-4-检索路由配置" class="sidebar-link" data-v-40a3448a>15.4. 检索路由配置</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_15-5-检索单个路由配置" class="sidebar-link" data-v-40a3448a>15.5. 检索单个路由配置</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_15-6-创建或者删除单个路由配置" class="sidebar-link" data-v-40a3448a>15.6. 创建或者删除单个路由配置</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_15-7-所有端点的列表" class="sidebar-link" data-v-40a3448a>15.7. 所有端点的列表</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_17-1-自定义断言" class="sidebar-link" data-v-40a3448a>17.1. 自定义断言</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_17-2-自定义-gatewayfilter" class="sidebar-link" data-v-40a3448a>17.2. 自定义 GatewayFilter</a></li><li class="level-2" data-v-40a3448a><a href="/2021/2021-04-20-Spring-Cloud-Gateway-Docs-Note.html#_17-3-自定义-globalfilter" class="sidebar-link" data-v-40a3448a>17.3. 自定义 GlobalFilter</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div></div></div>
    <script src="/assets/js/app.fa674bd4.js" defer></script><script src="/assets/js/3.dae3c35c.js" defer></script><script src="/assets/js/1.b7bb3f41.js" defer></script><script src="/assets/js/45.a4655f26.js" defer></script>
  </body>
</html>
